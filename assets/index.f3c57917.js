import{I,e as D,J,K,L as Q,d as W,r as U,M as X,a as _,w as z,o as Y,N as Z,O as $,u as k,h as ee,_ as te,Q as ne,c as P,j as B,b as E,R as ae}from"./index.da7f9356.js";import{R as ie}from"./index.8ce1e16c.js";function R(n){var e,t=function(l){return function(){e=null,n.apply(void 0,D(l))}},a=function(){if(e==null){for(var l=arguments.length,d=new Array(l),c=0;c<l;c++)d[c]=arguments[c];e=I(t(d))}};return a.cancel=function(){return I.cancel(e)},a}function T(n){return n!==window?n.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function F(n,e,t){if(t!==void 0&&e.top>n.top-t)return"".concat(t+e.top,"px")}function H(n,e,t){if(t!==void 0&&e.bottom<n.bottom+t){var a=window.innerHeight-e.bottom;return"".concat(t+a,"px")}}var G=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"],y=[];function j(n,e){if(!!n){var t=y.find(function(a){return a.target===n});t?t.affixList.push(e):(t={target:n,affixList:[e],eventHandlers:{}},y.push(t),G.forEach(function(a){t.eventHandlers[a]=J(n,a,function(){t.affixList.forEach(function(s){var l=s.exposed.lazyUpdatePosition;l()},(a==="touchstart"||a==="touchmove")&&K?{passive:!0}:!1)})}))}}function M(n){var e=y.find(function(t){var a=t.affixList.some(function(s){return s===n});return a&&(t.affixList=t.affixList.filter(function(s){return s!==n})),a});e&&e.affixList.length===0&&(y=y.filter(function(t){return t!==e}),G.forEach(function(t){var a=e.eventHandlers[t];a&&a.remove&&a.remove()}))}function re(){return typeof window!="undefined"?window:null}var m;(function(n){n[n.None=0]="None",n[n.Prepare=1]="Prepare"})(m||(m={}));var oe=function(){return{offsetTop:Number,offsetBottom:Number,target:{type:Function,default:re},prefixCls:String,onChange:Function,onTestUpdatePosition:Function}},fe=W({name:"AAffix",props:oe(),setup:function(e,t){var a=t.slots,s=t.emit,l=t.expose,d=U(),c=U(),f=X({affixStyle:void 0,placeholderStyle:void 0,status:m.None,lastAffix:!1,prevTarget:null,timeout:null}),g=ae(),S=_(function(){return e.offsetBottom===void 0&&e.offsetTop===void 0?0:e.offsetTop}),b=_(function(){return e.offsetBottom}),O=function(){var r=f.status,x=f.lastAffix,v=e.target;if(!(r!==m.Prepare||!c.value||!d.value||!v)){var p=v();if(!!p){var o={status:m.None},w=T(p),u=T(d.value),N=F(u,w,S.value),L=H(u,w,b.value);N!==void 0?(o.affixStyle={position:"fixed",top:N,width:u.width+"px",height:u.height+"px"},o.placeholderStyle={width:u.width+"px",height:u.height+"px"}):L!==void 0&&(o.affixStyle={position:"fixed",bottom:L,width:u.width+"px",height:u.height+"px"},o.placeholderStyle={width:u.width+"px",height:u.height+"px"}),o.lastAffix=!!o.affixStyle,x!==o.lastAffix&&s("change",o.lastAffix),E(f,o)}}},C=function(){E(f,{status:m.Prepare,affixStyle:void 0,placeholderStyle:void 0}),g.update()},h=R(function(){C()}),A=R(function(){var i=e.target,r=f.affixStyle;if(i&&r){var x=i();if(x&&d.value){var v=T(x),p=T(d.value),o=F(p,v,S.value),w=H(p,v,b.value);if(o!==void 0&&r.top===o||w!==void 0&&r.bottom===w)return}}C()});l({updatePosition:h,lazyUpdatePosition:A}),z(function(){return e.target},function(i){var r=(i==null?void 0:i())||null;f.prevTarget!==r&&(M(g),r&&(j(r,g),h()),f.prevTarget=r)}),z(function(){return[e.offsetTop,e.offsetBottom]},h),Y(function(){var i=e.target;i&&(f.timeout=setTimeout(function(){j(i(),g),h()}))}),Z(function(){O()}),$(function(){clearTimeout(f.timeout),M(g),h.cancel(),A.cancel()});var V=k("affix",e),q=V.prefixCls;return function(){var i,r=f.affixStyle,x=f.placeholderStyle,v=ee(te({},q.value,r)),p=ne(e,["prefixCls","offsetTop","offsetBottom","target","onChange","onTestUpdatePosition"]);return P(ie,{onResize:h},{default:function(){return[P("div",B(B({},p),{},{style:x,ref:d}),[P("div",{class:v,ref:c,style:r},[(i=a.default)===null||i===void 0?void 0:i.call(a)])])]}})}}}),le=Q(fe);export{le as _};
